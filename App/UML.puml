@startuml
'https://plantuml.com/class-diagram

class MainActivity {
    #onCreate(savedInstanceState: Bundle)
}

class ProfileActivity {
    -TextView firstName
    -TextView lastName
    -TextView contact
    -ImageView profPic
    -UserController userController
    -DatabaseController databaseController
    -TabLayout tabLayout
    -FrameLayout frameLayout
    #onCreate(savedInstanceState: Bundle)
}

class UserController {
    -User user
    -String defaultUUID
    -String prefName
    +User getUser()
    +setUser(user: User)
    +String getUserID(context: Context)
    +saveUUID(context: Context, id: String)
    +putUserToFirestore()
    +getUserFromFirestore(id: String)
    +selectImage(activity: Activity)
    +selectImage(fragment: Fragment)
    +editProfile(firstName: String, lastName: String,
    contact: String, pictureUri: Uri)
    +uploadProfilePicture(picture: Uri)
    +updateWithProfPictureFromWeb()
}

class DatabaseController {
    -FirebaseFirestore db
    -FirebaseStorage storage
    +putUserToFirestore(user: User)
    +updateWithUserFromFirestore(id: String, userController: UserController)
    +getUserFromFirestore(id: String, callback: UserCallback)
    +uploadProfilePicture(picture: Uri, user: User)
    +updateWithProfPictureFromWeb(user: User)
    +getUserProfilePicture(userID: String, callback: ImageUriCallback)
    +putEventPosterToFirestore(String: eventID, Uri imageUri)
    +putEventCheckInQRCodeToFirestore(String: eventID, Uri imageUri)
    +putEventDesscriptionQRCodeToFirestore(String: eventID, Uri imageUri)
    +getEventPoster(String eventID, callback: EventImageUriCallbacks)
    +getEventCheckInQRCode(String eventID, callback: EventImageUriCallbacks)
    +getEventDescriptionQRCode(String eventID, callback: EventImageUriCallbacks)
    +pushEventToFirestore(event: Event)
    +getEventFromFirestore(eventID: String, callback: GetEventCallback)
    +getAllEventsFromFirestore(callback: GetAllEventsCallback)
}

class Event {
    -String id
    -String name
    -int capacity
    -Collection<User> signedUpUsers
    -Collection<User> checkedInUsers
    -Object eventPoster
    -Object location
    -Date date
    +String getId()
    +setId(id: String)
    +String getName()
    +setName(name: String)
    +int getCapacity()
    +setCapacity(capacity: int)
    +boolean isCapped()
    +boolean isFull()
    +checkInUser(user: User)
    +Collection<User> getCheckedInUsers()
    +boolean isUserCheckedIn(user: User)
    +signUpUser(user: User)
    +Collection<User> getSignedUpUsers()
    +boolean isUserSignedUp(user: User)
}

class User {
    -String profilePicPath
    -String id
    -String firstName
    -String lastName
    -String contact
    -Collection<Event> attendingEvents
    -Collection<Event> hostingEvents
    -Uri picture
    -String imgUrl
    +String getId()
    +setId(id: String)
    +String getFirstName()
    +setFirstName(firstName: String)
    +String getLastName()
    +setLastName(lastName: String)
    +Collection<Event> getAttendingEvents()
    +Collection<Event> getHostingEvents()
    +String getContact()
    +setContact(contact: String)
    +checkIn(event: Event)
    +signUp(event: Event)
    +Uri getPicture()
    +setPicture(picture: Uri)
    +String getImgUrl()
    +setImgUrl(imgUrl: String)
}

class CheckInFragment {
    -DatabaseController databaseController
    -ActivityResultLauncher<ScanOptions> scanLauncher
    -processResult(ScanIntentResult: result)
}

checkInFragment "1" o-- "1" DatabaseController : has
CheckInFragment <|-- Fragment : extends
CheckInFragment <|.. ScanButtonListener : implements
CheckInFragment <|.. GetEventCallback : implements

class Admin

class EditProfileFragment {
    -OnProfileUpdateListener profileUpdateListener
    -EditText firstName
    -EditText lastName
    -EditText contact
    -ImageView profPic
    -UserController userController
    +setOnProfileUpdateListener(listener: OnProfileUpdateListener)
}

class ToolbarFragment
class Fragment
interface OnProfileUpdateListener {
    +onProfileUpdate(newFirstName: String, newLastName: String, newContact: String, newPicture: Uri)
}

class EventArrayAdapter {
    -ArrayList<Event> events
    -Context context
    +getView(position: int, convertView: View, parent: ViewGroup
}

interface GetAllEventsCallback {
    +onGetAllEventsCallback(event: Event)
}

class HomeFragment {
    -DatabaseController dbController
    -ArrayList<Event> events
    -ListView eventsList
    -EventArrayAdapter eventsArrayAdapter
}

Fragment <|-- ToolbarFragment
Fragment <|-- EditProfileFragment

AppCompatActivity <|-- MainActivity : extends
AppCompatActivity <|-- ProfileActivity : extends

ProfileActivity <|.. OnProfileUpdateListener : implements

UserController "1" o-- "1" ProfileActivity : has
UserController "1" o-- "1" User : has

DatabaseController -- User : takes as argument
DatabaseController -- UserController : takes as argument

EditProfileFragment o-- UserController

Event "*" o-- "*" User

User <|-- Admin : extends

skinparam linetype ortho
@enduml